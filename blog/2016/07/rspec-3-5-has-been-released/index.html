<!DOCTYPE html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"><![endif]-->
<!--[if IE 7]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if IE 8]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]<!--><html class="no-js" lang="en"><!--<![endif]--><head><meta charset="UTF-8" /><meta content="width=device-width, initial-scale=1" name="viewport" /><meta content="RSpec 3.5 has been released!" property="og:title" /><meta content="https://rspec.info/blog/2016/07/rspec-3-5-has-been-released/" property="og:url" /><meta content="https://rspec.info/images/logo_ogp.png" property="og:image" /><meta content="summary" name="twitter:card" /><meta content="@rspec" name="twitter:site" /><title>RSpec 3.5 has been released!</title><link href="/stylesheets/pages/blog.css" rel="stylesheet" type="text/css" /><link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet" type="text/css" /><link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro" rel="stylesheet" type="text/css" /><link href="https://fonts.googleapis.com/css?family=Inconsolata" rel="stylesheet" type="text/css" /><link href="/blog/feed.xml" rel="alternate" type="application/atom+xml" /></head><body class="blog"><header><nav><h1><img alt="Logo" src="/images/logo.png" /><a href="/">RSpec</a></h1><input class="hamburger-toggle" type="checkbox" /><div class="hamburger-icon"><div class="bar"></div><div class="bar"></div><div class="bar"></div></div><ul class="menu"><li><a href="/about">About</a></li><li><a href="/documentation">Documentation</a></li><li><a href="/blog">Blog</a></li><li><a href="/upgrading-from-rspec-2">Upgrade</a></li><li><a href="/help">Get Help</a></li><li><a href="/contributing">Contributing</a></li></ul></nav></header><section><article class="blog_post"><ul class="langs"><li class="lang current_lang">en</li><li class="lang"><a href="/ja/blog/2016/07/rspec-3-5-has-been-released/">ja</a></li></ul><h1>RSpec 3.5 has been released!</h1><h3 class="author">Sam Phippen, Myron Marston and Jon Rowe</h3><small class="date">Jul  1, 2016</small><p>RSpec 3.5 has just been released! Given our commitment to
<a href="http://semver.org/">semantic versioning</a>, this should be a trivial
upgrade for anyone already using RSpec 3, but if we did introduce
any regressions, please let us know, and we'll get a patch release
out with a fix ASAP.</p>

<p>RSpec continues to be a community-driven project with contributors
from all over the world. This release includes over 600 commits and 150
merged pull requests from over 50 different contributors!</p>

<p>Thank you to everyone who helped make this release happen!</p>

<h2 id="notable-changes">Notable Changes</h2>

<h3 id="core-configwhenfirstmatchingexampledefined">Core: <code>config.when_first_matching_example_defined</code></h3>

<p>We generally advise that you avoid putting setup logic in <code>spec_helper.rb</code> that is
needed by only some of your specs–that way, you can minimize the boot time to
run isolated unit specs. Instead, that kind of setup logic can go in a file in
<code>spec/support</code>. Spec files that need it can then require the support file and tag the
example group to opt-in to any associated hooks and module inclusions, e.g.:</p>

<div class="highlight"><pre class="highlight ruby"><code><span class="nb">require</span> <span class="s1">'support/db'</span>

<span class="no">RSpec</span><span class="p">.</span><span class="nf">describe</span> <span class="no">SomeClassThatUsesTheDB</span><span class="p">,</span> <span class="ss">:db</span> <span class="k">do</span>
  <span class="c1"># ...</span>
<span class="k">end</span>
</code></pre></div>
<p>This works, but it's always felt sub-optimal that both the require and the <code>:db</code> tag
are necessary to make this work. It's duplication that happens in every spec file that
uses the DB. If I forget to put the <code>require 'support/db'</code> line in a spec file that uses
the DB, I can get in a situation where the spec file fails when run individually, but
passes when run with the entire suite (because other spec files load the support file).</p>

<p>RSpec 3.5 includes a new hook that works nicely in this situation. Instead of requiring
<code>support/db</code> in each spec file that needs it, you can configure RSpec to load it if
any examples tagged with <code>:db</code> are defined:</p>

<div class="highlight"><pre class="highlight ruby"><code><span class="no">RSpec</span><span class="p">.</span><span class="nf">configure</span> <span class="k">do</span> <span class="o">|</span><span class="n">config</span><span class="o">|</span>
  <span class="n">config</span><span class="p">.</span><span class="nf">when_first_matching_example_defined</span><span class="p">(</span><span class="ss">:db</span><span class="p">)</span> <span class="k">do</span>
    <span class="nb">require</span> <span class="s1">'support/db'</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div>
<p>This new <code>when_first_matching_example_defined</code> hook fires as soon as the first
example with matching metadata is defined, allowing you to configure things to
be loaded as needed based on metadata.  Of course, this new hook isn't limited to
just this use case, but it's one of the main ways we expect to see it used.</p>

<h3 id="core-configfilterrunwhenmatching">Core: <code>config.filter_run_when_matching</code></h3>

<p>One of the common uses for RSpec's metadata system is focus filtering. Before RSpec 3.5,
you'd configure it like this:</p>

<div class="highlight"><pre class="highlight ruby"><code><span class="no">RSpec</span><span class="p">.</span><span class="nf">configure</span> <span class="k">do</span> <span class="o">|</span><span class="n">config</span><span class="o">|</span>
  <span class="n">config</span><span class="p">.</span><span class="nf">filter_run</span> <span class="ss">:focus</span>
  <span class="n">config</span><span class="p">.</span><span class="nf">run_all_when_everything_filtered</span> <span class="o">=</span> <span class="kp">true</span>
<span class="k">end</span>
</code></pre></div>
<p>Then you can tag an example or group with <code>:focus</code> to have RSpec run just what you've tagged.
When nothing is tagged with <code>:focus</code> you want RSpec to ignore this filter, so the
<code>run_all_when_everything_filtered = true</code> option makes it do that.</p>

<p>Unfortunately, <code>run_all_when_everything_filtered</code> applies globally to <em>all</em> filtering
(not just <code>:focus</code> filtering), and it creates some surprising behavior in some situations.
(See <a href="https://github.com/rspec/rspec-core/issues/1920">this issue</a> for one example).
We realized that it would make a lot more sense to be able to setup <code>:focus</code> as a
<em>conditional</em> filter, so in RSpec 3.5 you can do that:</p>

<div class="highlight"><pre class="highlight ruby"><code><span class="no">RSpec</span><span class="p">.</span><span class="nf">configure</span> <span class="k">do</span> <span class="o">|</span><span class="n">config</span><span class="o">|</span>
  <span class="n">config</span><span class="p">.</span><span class="nf">filter_run_when_matching</span> <span class="ss">:focus</span>
<span class="k">end</span>
</code></pre></div>
<p>With this configuration, the <code>:focus</code> filtering will only apply if any examples
or groups are tagged with <code>:focus</code>. It also makes for shorter, simpler configuration!</p>

<h3 id="core-load-spec-files-in-order-specified-at-command-line">Core: Load spec files in order specified at command line</h3>

<p>RSpec 3.5 now loads spec files and directories in the order of your
command line arguments. This provides a simple way to order things in a
one-off manner. For example, for a particular spec run if you want your fast
unit specs to run before your slow acceptance specs, you can run RSpec like so:</p>

<div class="highlight"><pre class="highlight plaintext"><code>$ rspec spec/unit spec/acceptance --order defined
</code></pre></div>
<p>The <code>--order defined</code> bit is only needed if you've configured RSpec to normally
order things randomly (which we recommend as your default).</p>

<h3 id="core-shared-example-group-inclusion-changes">Core: Shared example group inclusion changes</h3>

<p>RSpec has supported the idea of a <em>shared context</em>–a shared example group defined
for the purpose of sharing contextual helpers and hooks–for a long time. You define
a shared context like this:</p>

<div class="highlight"><pre class="highlight ruby"><code><span class="no">RSpec</span><span class="p">.</span><span class="nf">shared_context</span> <span class="s2">"DB support"</span> <span class="k">do</span>
  <span class="n">let</span><span class="p">(</span><span class="ss">:db</span><span class="p">)</span> <span class="p">{</span> <span class="no">MyORM</span><span class="p">.</span><span class="nf">database</span> <span class="p">}</span>

  <span class="c1"># Wrap each example in a transaction...</span>
  <span class="n">around</span> <span class="k">do</span> <span class="o">|</span><span class="n">ex</span><span class="o">|</span>
    <span class="n">db</span><span class="p">.</span><span class="nf">transaction</span><span class="p">(</span><span class="ss">:rollback</span> <span class="o">=&gt;</span> <span class="ss">:always</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ex</span><span class="p">)</span>
  <span class="k">end</span>

  <span class="c1"># Interleave example begin/end messages in DB logs so it</span>
  <span class="c1"># is clear which SQL statements come from which examples.</span>
  <span class="n">before</span> <span class="k">do</span> <span class="o">|</span><span class="n">ex</span><span class="o">|</span>
    <span class="n">db</span><span class="p">.</span><span class="nf">logger</span><span class="p">.</span><span class="nf">info</span> <span class="s2">"Beginning example: </span><span class="si">#{</span><span class="n">ex</span><span class="p">.</span><span class="nf">metadata</span><span class="p">[</span><span class="ss">:full_description</span><span class="si">}</span><span class="s2">"</span>
  <span class="k">end</span>
  <span class="n">after</span> <span class="k">do</span> <span class="o">|</span><span class="n">ex</span><span class="o">|</span>
    <span class="n">db</span><span class="p">.</span><span class="nf">logger</span><span class="p">.</span><span class="nf">info</span> <span class="s2">"Ending example: </span><span class="si">#{</span><span class="n">ex</span><span class="p">.</span><span class="nf">metadata</span><span class="p">[</span><span class="ss">:full_description</span><span class="si">}</span><span class="s2">"</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div>
<p>To use this shared context, you can explicitly include it in a group with <code>include_context</code>:</p>

<div class="highlight"><pre class="highlight ruby"><code><span class="no">RSpec</span><span class="p">.</span><span class="nf">describe</span> <span class="no">MyModel</span> <span class="k">do</span>
  <span class="n">include_context</span> <span class="s2">"DB support"</span>
<span class="k">end</span>
</code></pre></div>
<p>We also supported a way of <em>implicitly</em> including the shared context in a group using matching metadata:</p>

<div class="highlight"><pre class="highlight ruby"><code><span class="no">RSpec</span><span class="p">.</span><span class="nf">shared_context</span> <span class="s2">"DB support"</span><span class="p">,</span> <span class="ss">:db</span> <span class="k">do</span>
  <span class="c1"># ...</span>
<span class="k">end</span>

<span class="c1"># ...</span>

<span class="no">RSpec</span><span class="p">.</span><span class="nf">describe</span> <span class="no">MyModel</span><span class="p">,</span> <span class="ss">:db</span> <span class="k">do</span>
  <span class="c1"># ...</span>
<span class="k">end</span>
</code></pre></div>
<p>This approach worked OK, but had several significant problems:</p>

<ul>
  <li>The first argument to <code>shared_context</code> (<code>"DB support"</code>) doesn't serve a purpose
beyond labelling what the group is for (which a comment could achieve just as well).</li>
  <li>Some users have expressed surprised that the metadata is treated "special" here and
isn't simply applied to the shared example group like it is applied to a normal example group.</li>
  <li>It makes it impossible to attach some metadata to a shared example group that will be
automatically applied to including example groups. For example, maybe you want to temporarily
add <code>:skip</code> or <code>:focus</code> metadata to all including groups. There was no way to do this.</li>
  <li>There's no obvious way to make a shared example group get auto-included in every
example group (e.g. for a global <code>before</code> hook or a <code>let</code> you want to make available everywhere…).</li>
  <li>It's inconsistent with how module inclusion works (e.g. <code>config.include DBSupport, :db</code>).</li>
</ul>

<p>In RSpec 3.5 we've rectified these problems with a couple of changes.</p>

<h4 id="new-api-configincludecontext">New API: <code>config.include_context</code></h4>

<p>You can now define shared context inclusions in your <code>RSpec.configure</code> block:</p>

<div class="highlight"><pre class="highlight ruby"><code><span class="no">RSpec</span><span class="p">.</span><span class="nf">configure</span> <span class="k">do</span> <span class="o">|</span><span class="n">config</span><span class="o">|</span>
  <span class="n">config</span><span class="p">.</span><span class="nf">include_context</span> <span class="s2">"DB support"</span><span class="p">,</span> <span class="ss">:db</span>
<span class="k">end</span>
</code></pre></div>
<p>This aligns with the existing <code>config.include</code> API for module inclusions, provides
a way to include shared contexts based on metadata that is less surprising, and
makes it simple to include a shared context in all example groups (just don't
pass a metadata argument).</p>

<h4 id="new-config-option-configsharedcontextmetadatabehavior">New config option: <code>config.shared_context_metadata_behavior</code></h4>

<p>We've also added a config option that lets you determine how shared context
metadata is treated:</p>

<div class="highlight"><pre class="highlight ruby"><code><span class="no">RSpec</span><span class="p">.</span><span class="nf">configure</span> <span class="k">do</span> <span class="o">|</span><span class="n">config</span><span class="o">|</span>
  <span class="n">config</span><span class="p">.</span><span class="nf">shared_context_metadata_behavior</span> <span class="o">=</span> <span class="ss">:trigger_inclusion</span>
  <span class="c1"># or</span>
  <span class="n">config</span><span class="p">.</span><span class="nf">shared_context_metadata_behavior</span> <span class="o">=</span> <span class="ss">:apply_to_host_groups</span>
<span class="k">end</span>
</code></pre></div>
<p>The former value (<code>:trigger_inclusion</code>) is the default and exists only for backwards
compatibility. It treats metadata passed to <code>RSpec.shared_context</code> exactly how it was
treated in RSpec 3.4 and before: it triggers inclusion in groups with matching metadata.
We plan to remove support for it in RSpec 4.</p>

<p>The latter value (<code>:apply_to_host_groups</code>) opts-in to the new behavior. Instead of
triggering inclusion in groups with matching metadata, it applies the metadata to host
groups.  For example, you could focus on all groups that use the DB by tagging your
shared context:</p>

<div class="highlight"><pre class="highlight ruby"><code><span class="no">RSpec</span><span class="p">.</span><span class="nf">shared_context</span> <span class="s2">"DB support"</span><span class="p">,</span> <span class="ss">:focus</span> <span class="k">do</span>
  <span class="c1"># ...</span>
<span class="k">end</span>
</code></pre></div>
<h3 id="expectations-keyword-argument-support-for-the-respondto-matcher">Expectations: Keyword argument support for the <code>respond_to</code> matcher.</h3>

<p>Keyword arguments have been a stable language feature for some time now but RSpec
has lacked support for placing expectations upon keyword arguments in a variety of our matchers.</p>

<p>In rspec-expectations 3.5 we add support for checking whether an object responds to a method
using keyword arguments. You'll now be able to check a method's response signature for particular
keyword(s) as well as a count of traditional arguments.</p>

<div class="highlight"><pre class="highlight ruby"><code><span class="n">expect</span><span class="p">(</span><span class="n">my_object</span><span class="p">).</span><span class="nf">to</span> <span class="n">respond_to</span><span class="p">(</span><span class="ss">:find</span><span class="p">).</span><span class="nf">with_keywords</span><span class="p">(</span><span class="ss">:limit</span><span class="p">,</span> <span class="ss">:offset</span><span class="p">)</span>
<span class="n">expect</span><span class="p">(</span><span class="n">my_object</span><span class="p">).</span><span class="nf">to</span> <span class="n">respond_to</span><span class="p">(</span><span class="ss">:find</span><span class="p">).</span><span class="nf">with</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="nf">argument</span><span class="p">.</span><span class="nf">and_keywords</span><span class="p">(</span><span class="ss">:limit</span><span class="p">,</span> <span class="ss">:offset</span><span class="p">)</span>
</code></pre></div>
<p>We're also expanding the matchers existing capabilities, adding the ability
 to check for a range of arguments, or unlimited arguments in addition to a specific
 number. e.g:</p>

<div class="highlight"><pre class="highlight ruby"><code><span class="n">expect</span><span class="p">(</span><span class="n">my_object</span><span class="p">).</span><span class="nf">to</span> <span class="n">respond_to</span><span class="p">(</span><span class="ss">:build</span><span class="p">).</span><span class="nf">with</span><span class="p">(</span><span class="mi">2</span><span class="o">..</span><span class="mi">3</span><span class="p">).</span><span class="nf">arguments</span>
<span class="n">expect</span><span class="p">(</span><span class="n">my_object</span><span class="p">).</span><span class="nf">to</span> <span class="n">respond_to</span><span class="p">(</span><span class="ss">:build</span><span class="p">).</span><span class="nf">with_unlimited_arguments</span>
</code></pre></div>
<p>A big thank you to Rob Smith for the work you put into making this a part of RSpec.</p>

<h3 id="expectations-minitest-integration-now-works-with-minitest-56">Expectations: Minitest integration now works with Minitest 5.6+</h3>

<p>While rspec-expectations is normally used with rspec-core, you can easily use it
with other test frameworks.  We provide integration with Minitest.  Simply load
our Minitest support after loading Minitest itself:</p>

<div class="highlight"><pre class="highlight ruby"><code><span class="nb">require</span> <span class="s1">'rspec/expectations/minitest_integration'</span>
</code></pre></div>
<p>Unfortunately, Minitest 5.6 introduced its own <code>expect</code> method which conflicted with
the <code>expect</code> method we provide and broke this integration. There's a fix for this in
rspec-expectations 3.5.</p>

<h3 id="mocks-add-minitest-integration">Mocks: Add Minitest integration</h3>

<p>While we've long provided Minitest integration for rspec-expectations, we've never
provided the same level of simple integration with rspec-mocks. Instead, users had
to integrate rspec-mocks with Minitest themselves using the lifecycle hooks we provide.
This worked pretty well until the aforementioned <code>expect</code> method was added to Minitest 5.6
and broke things for users trying to use rspec-mocks with minitest. In rspec-mocks 3.5,
we now provide first-class support for usage with Minitest.  Just require our integration
file:</p>

<div class="highlight"><pre class="highlight ruby"><code><span class="nb">require</span> <span class="s1">'rspec/mocks/minitest_integration'</span>
</code></pre></div>
<h3 id="rails-support-for-rails-5">Rails: Support for Rails 5</h3>

<p>The headline here is that RSpec 3.5.0 is compatible with Rails 5. As Rails 5
betas and release candidates have been released, we've been releasing betas of
3.5.0 to keep up alongside Rails. Due to this being a major release of Rails
some APIs that we consume have been deprecated. RSpec is not doing a major
release and so  this only gets exposed to you, our users, in one place:
controller testing.</p>

<p>In <a href="https://github.com/rails/rails/issues/18950">Rails 5</a> <code>assigns</code> and
<code>assert_template</code> are "soft deprecated". Controller tests themselves <em>are not</em>,
and adding <code>:type =&gt; :controller</code> to your specs is still 100% supported.
Through Rails 3 and 4 it was both prevalent and idiomatic to use <code>assigns</code> in
controller specs. As this is a minor release of RSpec our commitment to SemVer
means that we are not going to break your existing controller specs. For
existing Rails applications that make heavy use of <code>assigns</code> adding the
<a href="https://github.com/rails/rails-controller-testing"><code>rails-controller-testing</code></a>
to your Gemfile will restore <code>assigns</code> and <code>assert_template</code>. RSpec integrates
with this gem seamlessly, so your controller specs should just continue to work.</p>

<p>For new Rails apps: we don't recommend adding the <code>rails-controller-testing</code> gem
to your application. The official recommendation of the Rails team and the RSpec
core team is to write  <a href="https://www.relishapp.com/rspec/rspec-rails/docs/request-specs/request-spec">request
specs</a>
instead. Request specs allow you to focus on a single controller action, but
unlike controller tests involve the router, the middleware stack, and both rack
requests and responses. This adds realism to the test that you are writing, and
helps avoid many of the issues that are common in controller specs. In Rails 5,
request specs are significantly faster than either request or controller specs
were in rails 4, thanks to the work by <a href="https://twitter.com/eileencodes?lang=en-gb">Eileen Uchitelle</a><sup id="fnref:foot_1"><a href="#fn:foot_1" class="footnote">1</a></sup> of the Rails Committer Team.</p>

<p>The other important feature of Rails 5 we wanted to discuss is ActionCable.
Unfortunately RSpec is not able to provide a clean way of testing
ActionCable at this time. Rails is working on a testing type for ActionCable
slated for release as part of Rails 5.1. We'll be watching that closely and work
something up when it's ready. In the mean time, we suggest you test ActionCable
through a browser, in an integrated fashion.</p>

<p>The work on Rails 5 represented a significant investment by a number of RSpec
Core Team members, and we received significant help from members of the Rails
Commiter and Core teams. We offer kind thanks to everyone that was involved with
making this possible.</p>

<h2 id="stats">Stats</h2>

<h3 id="combined">Combined:</h3>

<ul>
  <li><strong>Total Commits</strong>: 625</li>
  <li><strong>Merged pull requests</strong>: 192</li>
  <li><strong>62 contributors</strong>: Aaron Stone, Ahmed AbouElhamayed, Al Snow, Alex Altair,
Alexander Skiba, Alireza Bashiri, Andrew Kozin (aka nepalez), Andrew White,
Anton Rieder, Ben Saunders, Benjamin Quorning, Bradley Schaefer, Bruno Bonamin,
DarthSim, David Rodríguez, Diogo Benicá, Eliot Sykes, Fernando Seror, Gautam
Sawhney, Isaac Betesh, James Coleman, Joe Rafaniello, John Schroeder, Jon Moss,
Jon Rowe, Jun Aruga, Kilian Cirera Sant, Koen Punt, Liss McCabe, Marc Ignacio,
Martin Emde, Matt Jones, Michele Piccirillo, Miklos Fazekas, Myron Marston,
Patrik Wenger, Perry Smith, Peter Swan, Prem Sichanugrist, Rob, Rob Smith, Ryan
Beckman, Ryan Clark, Sam Phippen, Scott Bronson, Sergey Pchelintsev, Simon
Coffey, Thomas Hart II, Timo Schilling, Tobias Bühlmann, Travis Grathwell,
William Jeffries, Wojciech Wnętrzak, Xavier Shay, Yoshihiro Ashida, Yuji
Nakayama, Zshawn Syed, chrisarcand, liam-m, mrageh, sleepingkingstudios, yui-knk</li>
</ul>

<h3 id="rspec-core">rspec-core:</h3>

<ul>
  <li><strong>Total Commits</strong>: 194</li>
  <li><strong>Merged pull requests</strong>: 66</li>
  <li><strong>18 contributors</strong>: Alexander Skiba, Alireza Bashiri, Benjamin Quorning,
Bradley Schaefer, Jon Moss, Jon Rowe, Matt Jones, Michele Piccirillo, Myron
Marston, Patrik Wenger, Perry Smith, Sam Phippen, Simon Coffey, Thomas Hart II,
Travis Grathwell, Yuji Nakayama, mrageh, yui-knk</li>
</ul>

<h3 id="rspec-expectations">rspec-expectations:</h3>

<ul>
  <li><strong>Total Commits</strong>: 83</li>
  <li><strong>Merged pull requests</strong>: 25</li>
  <li><strong>14 contributors</strong>: Alex Altair, Ben Saunders, Benjamin Quorning, Bradley
Schaefer, James Coleman, Jon Rowe, Myron Marston, Rob Smith, Sam Phippen,
William Jeffries, Yuji Nakayama, Zshawn Syed, chrisarcand, sleepingkingstudios</li>
</ul>

<h3 id="rspec-mocks">rspec-mocks:</h3>

<ul>
  <li><strong>Total Commits</strong>: 82</li>
  <li><strong>Merged pull requests</strong>: 28</li>
  <li><strong>17 contributors</strong>: Andrew Kozin (aka nepalez), Benjamin Quorning, Bradley
Schaefer, Bruno Bonamin, David Rodríguez, Isaac Betesh, Joe Rafaniello, Jon
Rowe, Kilian Cirera Sant, Marc Ignacio, Martin Emde, Myron Marston, Patrik
Wenger, Ryan Beckman, Sam Phippen, Tobias Bühlmann, Yuji Nakayama</li>
</ul>

<h3 id="rspec-rails">rspec-rails:</h3>

<ul>
  <li><strong>Total Commits</strong>: 185</li>
  <li><strong>Merged pull requests</strong>: 47</li>
  <li><strong>31 contributors</strong>: Ahmed AbouElhamayed, Al Snow, Andrew White, Anton Rieder,
Benjamin Quorning, Bradley Schaefer, DarthSim, David Rodríguez, Diogo Benicá,
Eliot Sykes, Fernando Seror, Gautam Sawhney, John Schroeder, Jon Rowe, Jun
Aruga, Koen Punt, Liss McCabe, Miklos Fazekas, Myron Marston, Peter Swan, Prem
Sichanugrist, Rob, Ryan Clark, Sam Phippen, Scott Bronson, Sergey Pchelintsev,
Timo Schilling, Wojciech Wnętrzak, Xavier Shay, Yoshihiro Ashida, Yuji Nakayama</li>
</ul>

<h3 id="rspec-support">rspec-support:</h3>

<ul>
  <li><strong>Total Commits</strong>: 81</li>
  <li><strong>Merged pull requests</strong>: 26</li>
  <li><strong>8 contributors</strong>: Aaron Stone, Bradley Schaefer, Jon Rowe, Myron Marston,
Sam Phippen, Yuji Nakayama, liam-m, sleepingkingstudios</li>
</ul>

<h2 id="docs">Docs</h2>

<h3 id="api-docs">API Docs</h3>

<ul>
  <li><a href="/documentation/3.5/rspec-core/">rspec-core</a></li>
  <li><a href="/documentation/3.5/rspec-expectations/">rspec-expectations</a></li>
  <li><a href="/documentation/3.5/rspec-mocks/">rspec-mocks</a></li>
  <li><a href="/documentation/3.5/rspec-rails/">rspec-rails</a></li>
</ul>

<h3 id="cucumber-features">Cucumber Features</h3>

<ul>
  <li><a href="http://relishapp.com/rspec/rspec-core">rspec-core</a></li>
  <li><a href="http://relishapp.com/rspec/rspec-expectations">rspec-expectations</a></li>
  <li><a href="http://relishapp.com/rspec/rspec-mocks">rspec-mocks</a></li>
  <li><a href="http://relishapp.com/rspec/rspec-rails">rspec-rails</a></li>
</ul>

<h2 id="release-notes">Release Notes</h2>

<h3 id="rspec-core-combining-all-betas-of-rspec-350">RSpec Core (combining all betas of RSpec 3.5.0)</h3>

<h4 id="section">3.5.0 / 2016-07-01</h4>
<p><a href="http://github.com/rspec/rspec-core/compare/v3.5.0.beta4...v3.5.0">Full Changelog</a></p>

<p>Enhancements:</p>

<ul>
  <li>Include any <code>SPEC_OPTS</code> in reproduction command printed at the end of
a bisect run. (Simon Coffey, #2274)</li>
</ul>

<p>Bug Fixes:</p>

<ul>
  <li>Handle <code>--bisect</code> in <code>SPEC_OPTS</code> environment variable correctly so as
to avoid infinite recursion. (Simon Coffey, #2271)</li>
</ul>

<h4 id="beta4--2016-06-05">3.5.0.beta4 / 2016-06-05</h4>
<p><a href="http://github.com/rspec/rspec-core/compare/v3.5.0.beta3...v3.5.0.beta4">Full Changelog</a></p>

<p>Enhancements:</p>

<ul>
  <li>Filter out bundler stackframes from backtraces by default, since
Bundler 1.12 now includes its own frames in stack traces produced
by using <code>bundle exec</code>. (Myron Marston, #2240)</li>
  <li>HTML Formatter uses exception presenter to get failure message
for consistency with other formatters. (@mrageh, #2222)</li>
  <li>Load spec files in the order of the directories or files passed
at the command line, making it easy to make some specs run before
others in a one-off manner.  For example, <code>rspec spec/unit
spec/acceptance --order defined</code> will run unit specs before acceptance
specs. (Myron Marston, #2253)</li>
  <li>Add new <code>config.include_context</code> API for configuring global or
filtered inclusion of shared contexts in example groups.
(Myron Marston, #2256)</li>
  <li>Add new <code>config.shared_context_metadata_behavior = :apply_to_host_groups</code>
option, which causes shared context metadata to be inherited by the
metadata hash of all host groups and examples instead of configuring
implicit auto-inclusion based on the passed metadata. (Myron Marston, #2256)</li>
</ul>

<p>Bug Fixes:</p>

<ul>
  <li>Fix <code>--bisect</code> so it works on large spec suites that were previously triggering
"Argument list too long errors" due to all the spec locations being passed as
CLI args. (Matt Jones, #2223).</li>
  <li>Fix deprecated <code>:example_group</code>-based filtering so that it properly
applies to matching example groups. (Myron Marston, #2234)</li>
  <li>Fix <code>NoMethodError</code> caused by Java backtraces on JRuby. (Michele Piccirillo, #2244)</li>
</ul>

<h4 id="beta3--2016-04-02">3.5.0.beta3 / 2016-04-02</h4>
<p><a href="http://github.com/rspec/rspec-core/compare/v3.5.0.beta2...v3.5.0.beta3">Full Changelog</a></p>

<p>Enhancements:</p>

<ul>
  <li>Add new <code>config.filter_run_when_matching</code> API, intended to replace
the combination of <code>config.filter_run</code> and
<code>config.run_all_when_everything_filtered</code> (Myron Marston, #2206)</li>
</ul>

<p>Bug Fixes:</p>

<ul>
  <li>Use the encoded string logic for source extraction. (Jon Rowe, #2183)</li>
  <li>Fix rounding issue in duration formatting helper. (Fabersky, Jon Rowe, #2208)</li>
  <li>Fix failure snippet extraction so that <code>def-end</code> snippets
ending with <code>end</code>-only line can be extracted properly.
(Yuji Nakayama, #2215)</li>
</ul>

<h4 id="beta2--2016-03-10">3.5.0.beta2 / 2016-03-10</h4>
<p><a href="http://github.com/rspec/rspec-core/compare/v3.5.0.beta1...v3.5.0.beta2">Full Changelog</a></p>

<p>Enhancements:</p>

<ul>
  <li>Remove unneeded <code>:execution_result</code> example group metadata, saving a
bit of memory. (Myron Marston, #2172)</li>
  <li>Apply hooks registered with <code>config</code> to previously defined groups.
(Myron Marston, #2189)</li>
  <li><code>RSpec::Core::Configuration#reporter</code> is now public API under SemVer.
(Jon Rowe, #2193)</li>
  <li>Add new <code>config.when_first_matching_example_defined</code> hook. (Myron
Marston, #2175)</li>
</ul>

<h4 id="beta1--2016-02-06">3.5.0.beta1 / 2016-02-06</h4>
<p><a href="http://github.com/rspec/rspec-core/compare/v3.4.4...v3.5.0.beta1">Full Changelog</a></p>

<p>Enhancements:</p>

<ul>
  <li>Add <code>RSpec::Core::ExampleGroup.currently_executing_a_context_hook?</code>,
primarily for use by rspec-rails. (Sam Phippen, #2131)</li>
</ul>

<p>Bug Fixes:</p>

<ul>
  <li>Ensure <code>MultipleExceptionError</code> does not contain a recursive reference
to itself. (Sam Phippen, #2133)</li>
</ul>

<h3 id="rspec-expectations-including-all-betas-of-rspec-350">RSpec Expectations (including all betas of RSpec 3.5.0)</h3>

<h4 id="section-1">3.5.0 / 2016-07-01</h4>
<p><a href="http://github.com/rspec/rspec-expectations/compare/v3.5.0.beta4...v3.5.0">Full Changelog</a></p>

<p><strong>No user facing changes since beta4</strong></p>

<h4 id="beta4--2016-06-05-1">3.5.0.beta4 / 2016-06-05</h4>
<p><a href="http://github.com/rspec/rspec-expectations/compare/v3.5.0.beta3...v3.5.0.beta4">Full Changelog</a></p>

<p>Bug Fixes:</p>

<ul>
  <li>Fix <code>include</code> matcher so that it provides a valid diff for hashes. (Yuji Nakayama, #916)</li>
</ul>

<h4 id="beta3--2016-04-02-1">3.5.0.beta3 / 2016-04-02</h4>
<p><a href="http://github.com/rspec/rspec-expectations/compare/v3.5.0.beta2...v3.5.0.beta3">Full Changelog</a></p>

<p>Enhancements:</p>

<ul>
  <li>Make <code>rspec/expectations/minitest_integration</code> work on Minitest::Spec
5.6+. (Myron Marston, #904)</li>
  <li>Add an alias <code>having_attributes</code> for <code>have_attributes</code> matcher.
(Yuji Nakayama, #905)</li>
  <li>Improve <code>change</code> matcher error message when block is mis-used.
(Alex Altair, #908)</li>
</ul>

<h4 id="beta2--2016-03-10-1">3.5.0.beta2 / 2016-03-10</h4>
<p><a href="http://github.com/rspec/rspec-expectations/compare/v3.5.0.beta1...v3.5.0.beta2">Full Changelog</a></p>

<p>Enhancements:</p>

<ul>
  <li>Add the ability to raise an error on encountering false positives via
<code>RSpec::Configuration#on_potential_false_positives = :raise</code>. (Jon Rowe, #900)</li>
  <li>When using the custom matcher DSL, support new
<code>notify_expectation_failures: true</code> option for the <code>match</code> method to
allow expectation failures to be raised as normal instead of being
converted into a <code>false</code> return value for <code>matches?</code>. (Jon Rowe, #892)</li>
</ul>

<p>Bug Fixes:</p>

<ul>
  <li>Allow <code>should</code> deprecation check to work on <code>BasicObject</code>s. (James Coleman, #898)</li>
</ul>

<h4 id="beta1--2016-02-06-1">3.5.0.beta1 / 2016-02-06</h4>
<p><a href="http://github.com/rspec/rspec-expectations/compare/v3.4.0...v3.5.0.beta1">Full Changelog</a></p>

<p>Enhancements:</p>

<ul>
  <li>Make <code>match_when_negated</code> in custom matcher DSL support use of
expectations within the match logic. (Chris Arcand, #789)</li>
</ul>

<p>Bug Fixes:</p>

<ul>
  <li>Return <code>true</code> as expected from passing negated expectations
(such as <code>expect("foo").not_to eq "bar"</code>), so they work
properly when used within a <code>match</code> or <code>match_when_negated</code>
block. (Chris Arcand, #789)</li>
</ul>

<h3 id="rspec-mocks-including-all-betas-of-rspec-350">RSpec Mocks (including all betas of RSpec 3.5.0)</h3>

<h4 id="section-2">3.5.0 / 2016-07-01</h4>
<p><a href="http://github.com/rspec/rspec-mocks/compare/v3.5.0.beta4...v3.5.0">Full Changelog</a></p>

<p>Enhancements:</p>

<ul>
  <li>Provides a nice string representation of
<code>RSpec::Mocks::MessageExpectation</code> (Myron Marston, #1095)</li>
</ul>

<h4 id="beta4--2016-06-05-2">3.5.0.beta4 / 2016-06-05</h4>
<p><a href="http://github.com/rspec/rspec-mocks/compare/v3.5.0.beta3...v3.5.0.beta4">Full Changelog</a></p>

<p>Enhancements:</p>

<ul>
  <li>Add <code>and_throw</code> to any instance handling. (Tobias Bühlmann, #1068)</li>
</ul>

<h4 id="beta3--2016-04-02-2">3.5.0.beta3 / 2016-04-02</h4>
<p><a href="http://github.com/rspec/rspec-mocks/compare/v3.5.0.beta2...v3.5.0.beta3">Full Changelog</a></p>

<p>Enhancements:</p>

<ul>
  <li>Issue warning when attempting to use unsupported
<code>allow(...).to receive(...).ordered</code>. (Jon Rowe, #1000)</li>
  <li>Add <code>rspec/mocks/minitest_integration</code>, to properly integrate rspec-mocks
with minitest. (Myron Marston, #1065)</li>
</ul>

<h4 id="beta2--2016-03-10-2">3.5.0.beta2 / 2016-03-10</h4>
<p><a href="http://github.com/rspec/rspec-mocks/compare/v3.5.0.beta1...v3.5.0.beta2">Full Changelog</a></p>

<p>Enhancements:</p>

<ul>
  <li>Improve error message displayed when using <code>and_wrap_original</code> on pure test
doubles. (betesh, #1063)</li>
</ul>

<p>Bug Fixes:</p>

<ul>
  <li>Fix issue that prevented <code>receive_message_chain(...).with(...)</code> working
correctly on "any instance" mocks. (Jon Rowe, #1061)</li>
</ul>

<h4 id="beta1--2016-02-06-2">3.5.0.beta1 / 2016-02-06</h4>
<p><a href="http://github.com/rspec/rspec-mocks/compare/v3.4.1...v3.5.0.beta1">Full Changelog</a></p>

<p>Bug Fixes:</p>

<ul>
  <li>Allow <code>any_instance_of(...).to receive(...)</code> to use <code>and_yield</code> multiple
times. (Kilian Cirera Sant, #1054)</li>
  <li>Allow matchers which inherit from <code>rspec-mocks</code> matchers to be used for
<code>allow</code>. (Andrew Kozin, #1056)</li>
  <li>Prevent stubbing <code>respond_to?</code> on partial doubles from causing infinite
recursion. (Jon Rowe, #1013)</li>
  <li>Prevent aliased methods from disapearing after being mocked with
<code>any_instance</code> (regression from #1043). (Joe Rafaniello, #1060)</li>
</ul>

<h3 id="rspec-support-including-all-betas-of-rspec-350">RSpec Support (including all betas of RSpec 3.5.0)</h3>

<h4 id="section-3">3.5.0 / 2016-07-01</h4>
<p><a href="http://github.com/rspec/rspec-support/compare/v3.5.0.beta4...v3.5.0">Full Changelog</a></p>

<p><strong>No user facing changes since beat4</strong></p>

<h4 id="beta4--2016-06-05-3">3.5.0.beta4 / 2016-06-05</h4>
<p><a href="http://github.com/rspec/rspec-support/compare/v3.5.0.beta3...v3.5.0.beta4">Full Changelog</a></p>

<p>Enhancements:
* Improve <code>MethodSignature</code> to better support keyword arguments. (#250, Rob Smith).</p>

<h4 id="beta3--2016-04-02-3">3.5.0.beta3 / 2016-04-02</h4>
<p><a href="http://github.com/rspec/rspec-support/compare/v3.5.0.beta2...v3.5.0.beta3">Full Changelog</a></p>

<p>Bug Fixes:</p>

<ul>
  <li>Fix <code>EncodedString</code> to properly handle the behavior of <code>String#split</code>
on JRuby when the string contains invalid bytes. (Jon Rowe, #268)</li>
  <li>Fix <code>ObjectFormatter</code> so that formatting objects that don't respond to
<code>#inspect</code> (such as <code>BasicObject</code>) does not cause <code>NoMethodError</code>.
(Yuji Nakayama, #269)</li>
  <li>Fix <code>ObjectFormatter</code> so that formatting recursive array or hash does not
cause <code>SystemStackError</code>. (Yuji Nakayama, #270, #272)</li>
</ul>

<h4 id="beta2--2016-03-10-3">3.5.0.beta2 / 2016-03-10</h4>
<p><a href="http://github.com/rspec/rspec-support/compare/v3.5.0.beta1...v3.5.0.beta2">Full Changelog</a></p>

<p>No user-facing changes.</p>

<h4 id="beta1--2016-02-06-3">3.5.0.beta1 / 2016-02-06</h4>
<p><a href="http://github.com/rspec/rspec-support/compare/v3.4.1...v3.5.0.beta1">Full Changelog</a></p>

<h2 id="footnotes">Footnotes</h2>

<div class="footnotes">
  <ol>
    <li id="fn:foot_1">
      <p>See also Eileen's <a href="https://www.youtube.com/watch?v=oT74HLvDo_A">talk about request spec performance</a> <a href="#fnref:foot_1" class="reversefootnote">&#8617;</a></p>
    </li>
  </ol>
</div>
<div id="disqus_thread"></div>
<script type="text/javascript">
  /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
  var disqus_shortname  = 'rspec';
  var disqus_identifier = '/blog/2016/07/rspec-3-5-has-been-released/';
  var disqus_title      = 'RSpec 3.5 has been released!';
  var disqus_url        = 'http://rspec.info/blog/2016/07/rspec-3-5-has-been-released/';

  /* * * DON'T EDIT BELOW THIS LINE * * */
  (function() {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</article></section><footer><div>Created with the assistance of Ninefold<img alt="Brutus" src="/images/brutus-half.png" /></div><br /><a href="https://dnsimple.link/resolving-rspec" target="_blank">Resolving with<br /><img alt="DNSimple" style="width:100px;" src="https://cdn.dnsimple.com/assets/resolving-with-us/logo-dark.png" /></a></footer><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59095215-1', 'auto');
  ga('send', 'pageview');

</script>
<script>
  var SeedAndDewConfig = {};
  (function() {
    SeedAndDewConfig['adClass'] = "snd-ad";
    /* * * DON'T EDIT BELOW THIS LINE * * */
    SeedAndDewConfig['projectId'] = 'ef35b4ec-231e-4950-bd93-4c06fe3b2543';
    SeedAndDewConfig['loadStartTime'] = performance.now();
    SeedAndDewConfig['apiVersion'] = '2018-05-28'
    SeedAndDewConfig['sessionId'] = Math.random().toString(36).substring(2, 15);
    var snd = document.createElement('script');
    snd.type = 'text/javascript';
    snd.async = true;
    snd.src = 'https://www.seedanddew.com/static/embed.min.js';
    (document.getElementsByTagName('head')[0] ||
    document.getElementsByTagName('body')[0]).appendChild(snd);
  })();
</script>
</body></html>